{"version":3,"sources":["js/helpers/Globals.js","js/functions/PlayIcon.js","audio/spirals-no-1.ogg","audio/spirals-no-1.mid","js/P5SketchWithAudio.js","js/App.js","index.js"],"names":["window","p5","PlayIcon","id","className","xmlns","height","viewBox","width","d","fill","P5SketchWithAudio","sketchRef","useRef","Sketch","p","canvas","canvasWidth","innerWidth","canvasHeight","innerHeight","audioLoaded","player","PPQ","maxSpiralSize","loadMidi","Midi","fromUrl","midi","then","result","noteSet1","tracks","notes","noteSet2","noteSet3","noteSet4","filter","note","scheduleCueSet","document","getElementById","classList","add","remove","preload","song","loadSound","audio","onended","logCredits","noteSet","callbackName","poly","lastTicks","currentCue","i","length","ticks","time","addCue","setup","createCanvas","colorMode","HSB","stroke","noFill","background","noLoop","draw","isPlaying","executeCueSet1","sizeMultiplier","random","drawSpiral","executeCueSet2","spiralWidth","executeCueSet3","angle","size","delay","duration","executeCueSet4","timeouts","startX","startY","delayAmount","randomHue","oldX","oldY","push","setTimeout","newAngle","x","Math","sin","y","cos","strokeWeight","line","mousePressed","pause","parseInt","currentTime","buffer","reset","addClass","play","creditsLogged","ceil","console","log","clearTimeout","stop","updateCanvasDimensions","resizeCanvas","attachEvent","addEventListener","useEffect","current","ref","App","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.c825ae4f.chunk.js","sourcesContent":["// p5.sound doesn't work correctly when p5 is not available in the global name space so we add it here\n// https://github.com/processing/p5.js-sound/issues/512\nimport * as p5 from \"p5\";\nwindow.p5 = p5;\n","export default function PlayIcon() {\n    return (\n        <svg id=\"play-icon\" className='fade-out' xmlns=\"http://www.w3.org/2000/svg\" height=\"24\" viewBox=\"0 0 24 24\" width=\"24\">\n            <path d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M10 16.5l6-4.5-6-4.5v9zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\" />\n        </svg>\n    )\n}\n","export default __webpack_public_path__ + \"static/media/spirals-no-1.9185153b.ogg\";","export default __webpack_public_path__ + \"static/media/spirals-no-1.2ed6706e.mid\";","import React, { useRef, useEffect } from \"react\";\nimport \"./helpers/Globals\";\nimport \"p5/lib/addons/p5.sound\";\nimport * as p5 from \"p5\";\nimport { Midi } from '@tonejs/midi'\nimport PlayIcon from './functions/PlayIcon.js';\n\nimport audio from \"../audio/spirals-no-1.ogg\";\nimport midi from \"../audio/spirals-no-1.mid\";\n\nconst P5SketchWithAudio = () => {\n    const sketchRef = useRef();\n\n    const Sketch = p => {\n\n        p.canvas = null;\n\n        p.canvasWidth = window.innerWidth;\n\n        p.canvasHeight = window.innerHeight;\n\n        p.audioLoaded = false;\n\n        p.player = null;\n\n        p.PPQ = 3840 * 4;\n\n        p.maxSpiralSize = 0;\n\n        p.loadMidi = () => {\n            Midi.fromUrl(midi).then(\n                function(result) {\n                    const noteSet1 = result.tracks[3].notes; // Synth 2 - Init Patch\n                    const noteSet2 = result.tracks[4].notes; // Synth 3 - Bass Guitar\n                    const noteSet3 = result.tracks[2].notes; // Synth 4 - Solina Strings\n                    const noteSet4 = result.tracks[6].notes.filter(note => note.midi === 36 || note.midi === 37); // Redrum 1\n                    p.scheduleCueSet(noteSet1, 'executeCueSet1');\n                    p.scheduleCueSet(noteSet2, 'executeCueSet2');\n                    p.scheduleCueSet(noteSet3, 'executeCueSet3');\n                    p.scheduleCueSet(noteSet4, 'executeCueSet4');\n                    p.audioLoaded = true;\n                    document.getElementById(\"loader\").classList.add(\"loading--complete\");\n                    document.getElementById(\"play-icon\").classList.remove(\"fade-out\");\n                }\n            );\n            \n        }\n\n        p.preload = () => {\n            p.song = p.loadSound(audio, p.loadMidi);\n            p.song.onended(p.logCredits);\n        }\n\n        p.scheduleCueSet = (noteSet, callbackName, poly = false)  => {\n            let lastTicks = -1,\n                currentCue = 1;\n            for (let i = 0; i < noteSet.length; i++) {\n                const note = noteSet[i],\n                    { ticks, time } = note;\n                if(ticks !== lastTicks || poly){\n                    note.currentCue = currentCue;\n                    p.song.addCue(time, p[callbackName], note);\n                    lastTicks = ticks;\n                    currentCue++;\n                }\n            }\n        } \n\n        p.setup = () => {\n            p.canvas = p.createCanvas(p.canvasWidth, p.canvasHeight);\n            p.colorMode(p.HSB, 360, 100, 100);\n            p.stroke(255);\n            p.noFill();\n            p.background(0);\n            p.noLoop();\n            p.maxSpiralSize = p.width >= p.height ? p.height / 2 : p.width /2;\n        }\n\n        p.draw = () => {\n            if(p.audioLoaded && p.song.isPlaying()){\n\n            }\n        }\n\n        p.executeCueSet1 = (note) => {\n            if(note.currentCue < 90){\n                p.background(0);\n            }\n            const sizeMultiplier  = p.random(0.1, 5);\n            p.drawSpiral(p.width/8 * 7, p.height/4 * 3, sizeMultiplier, 3, 1);\n        }\n\n        p.executeCueSet2 = (note) => {\n            const sizeMultiplier  = 8,\n                spiralWidth = p.random(1, 20);\n            p.drawSpiral(p.width/4, p.height/2, sizeMultiplier, spiralWidth, 1);\n        }\n\n        p.executeCueSet3 = (note) => {\n            const sizeMultiplier  = p.random(4, 8),\n                spiralWidth = p.random(5, 10),\n                angle = p.random(8, 23),\n                size = p.maxSpiralSize * (sizeMultiplier / spiralWidth / angle),\n                delay = note.duration * 1000 / size;\n            p.drawSpiral(p.width/8 * 5, p.height/8 * 3, sizeMultiplier, spiralWidth, angle, delay);\n        }\n\n        p.executeCueSet4 = (note) => {\n            const { midi } = note,\n                sizeMultiplier  = p.random(1, 2);\n            if(midi === 36){\n                p.drawSpiral(p.width/2, p.height/8 * 7, sizeMultiplier, 3, 1, 1);\n            }\n            if(midi === 37){\n                p.drawSpiral(p.width/16 * 13, p.height/8 * 1.5, sizeMultiplier, 3, 1, 1);\n            }\n        }\n\n        p.timeouts = [];\n\n        p.drawSpiral = (startX, startY, sizeMultiplier = 1, spiralWidth = 20, angle = 1, delayAmount = 10) => {\n            const size = p.maxSpiralSize * (sizeMultiplier / spiralWidth / angle),\n                randomHue = p.random(0, 360);\n\n            let oldX = startX,\n                oldY = startY;   \n            \n            if(delayAmount < 0) {\n                delayAmount = 1000 / size;\n            }\n\n            for (let i = 0; i < size; i++) {\n                p.timeouts.push(\n                    setTimeout(\n                        function () {\n                            let newAngle = (angle/10) * i;\n                            let x = (startX) + (spiralWidth * newAngle) * Math.sin(newAngle);\n                            let  y = (startY) + (spiralWidth * newAngle) * Math.cos(newAngle);\n                            p.strokeWeight(12);\n                            p.stroke(randomHue, 100 / size * i, 100, 0.15); \n                            p.line(oldX, oldY, x, y);\n                            p.strokeWeight(2);\n                            p.stroke(randomHue, 100 / size * i, 100); \n                            p.line(oldX, oldY, x, y);\n                            oldX = x;\n                            oldY = y;\n                        },\n                        (delayAmount * i)\n                    )\n                );\n            }\n        }\n\n        p.mousePressed = () => {\n            if(p.audioLoaded){\n                if (p.song.isPlaying()) {\n                    p.song.pause();\n                } else {\n                    if (parseInt(p.song.currentTime()) >= parseInt(p.song.buffer.duration)) {\n                        p.reset();\n                    }\n                    document.getElementById(\"play-icon\").classList.add(\"fade-out\");\n                    p.canvas.addClass(\"fade-in\");\n                    p.song.play();\n                }\n            }\n            p.draw();\n        }\n\n        p.creditsLogged = false;\n\n        p.logCredits = () => {\n            if (\n                !p.creditsLogged &&\n                Math.ceil(p.song.currentTime()) >= parseInt(p.song.buffer.duration)\n            ) {\n                p.creditsLogged = true;\n                console.log(\n                    \"Music By: http://labcat.nz/\",\n                    \"\\n\",\n                    \"Animation By: https://github.com/LABCAT/\"\n                );\n                for (let i = 0; i < p.timeouts.length; i++) {\n                    clearTimeout(p.timeouts[i]);\n                }\n                p.song.stop();\n            }\n        };\n\n        p.reset = () => {\n\n        }\n\n        p.updateCanvasDimensions = () => {\n            p.canvasWidth = window.innerWidth;\n            p.canvasHeight = window.innerHeight;\n            p.canvas = p.resizeCanvas(p.canvasWidth, p.canvasHeight);\n        }\n\n        if (window.attachEvent) {\n            window.attachEvent(\n                'onresize',\n                function () {\n                    p.updateCanvasDimensions();\n                }\n            );\n        }\n        else if (window.addEventListener) {\n            window.addEventListener(\n                'resize',\n                function () {\n                    p.updateCanvasDimensions();\n                },\n                true\n            );\n        }\n        else {\n            //The browser does not support Javascript event binding\n        }\n    };\n\n    useEffect(() => {\n        new p5(Sketch, sketchRef.current);\n    }, []);\n\n    return (\n        <div ref={sketchRef}>\n            <PlayIcon />\n        </div>\n    );\n};\n\nexport default P5SketchWithAudio;\n","import P5SketchWithAudio from './P5SketchWithAudio'\n\nfunction App() {\n  return (\n    <P5SketchWithAudio/>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/build.css';\nimport App from './js/App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}